// define pins for ultrasonic sensors and LEDsTRIG4, 6, 8
const int trigPins[4] = {2, 4, 6, 8};   // Trig pins for each sensor
const int echoPins[4] = {3, 5, 7, 9};   // Echo pins for each sensor
const int buzzerPin = 10; // active buzzer pin

void setup() {
  Serial.begin(9600);

  // Initialize pins
  pinMode(buzzerPin, OUTPUT);

  for (int i = 0; i < 4; i++) {
    pinMode(trigPins[i], OUTPUT);
    pinMode(echoPins[i], INPUT);
  }

  Serial.println("4-Pin Ultrasonic Sensor System Ready!");
}

// Function to read distance (cm) from a 4-pin ultrasonic sensor
long readDistanceCM(int trigPin, int echoPin) {
  // Step 1: Trigger the ultrasonic pulse
  digitalWrite(trigPin, LOW);
  delayMicroseconds(2);
  digitalWrite(trigPin, HIGH);
  delayMicroseconds(10);  // typical trigger pulse width
  digitalWrite(trigPin, LOW);

  // Step 2: Measure echo pulse duration
  long duration = pulseIn(echoPin, HIGH, 30000);  // timeout = 30 ms

  // Step 3: Convert time (Âµs) to distance (cm)
  long distance = duration / 58.0;

  return distance;
}

void loop() {
  for (int i = 0; i < 4; i++) {
    long distance = readDistanceCM(trigPins[i], echoPins[i]);

    Serial.print("Sensor ");
    Serial.print(i + 1);
    Serial.print(": ");
    Serial.print(distance);
    Serial.println(" cm");
    
    // change freq of buzzer based on 
    int toneFreq = map(distance, 5, 100, 2000, 200); // frequency (Hz)
    // Turn buzzer ON if within 50 cm
    if (distance > 0 && distance <= 50) {
      tone(buzzerPin, toneFreq, 100);
      //delay(100);
    }
  }

  //delay(100); // small delay before next round
}
